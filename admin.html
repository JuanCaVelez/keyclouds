<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - KeyClouds</title>
    <link rel="stylesheet" href="styles/admin.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <header>
        <nav class="navbar">
            <div class="logo">
                <h1>KeyClouds</h1>
            </div>

            <ul class="nav-links">
                <li><a href="index.html">Inicio</a></li>
                <li><a href="index.html#productos">Productos</a></li>
                <li><a href="admin.html" class="active">Admin</a></li>
            </ul>

            <div class="admin-user-menu">
                <span class="admin-username">
                    <i class="fa-solid fa-user-shield"></i>
                    <span id="currentUser">Admin</span>
                </span>
                <button onclick="handleLogout()" class="btn-logout" title="Cerrar Sesión">
                    <i class="fa-solid fa-right-from-bracket"></i>
                    Salir
                </button>
            </div>
        </nav>
    </header>
    <section class="admin-section">
        <h2>Panel de Administración</h2>

        <!-- ===== FORMULARIO ===== -->
        <div class="admin-form-container">
            <h3 id="formTitle">Agregar Nuevo Producto</h3>

            <form id="productForm" class="product-form">
                <input type="hidden" id="productId">

                <div class="form-group">
                    <label for="productName">Nombre del Producto *</label>
                    <input type="text" id="productName" required>
                </div>

                <div class="form-group">
                    <label for="productCategory">Categoría *</label>
                    <select id="productCategory" required>
                        <option value="">Selecciona una categoría</option>
                    </select>
                    <small>Selecciona la categoría del producto</small>
                </div>

                <div class="form-group">
                    <label for="productPrice">Precio *</label>
                    <input type="text" id="productPrice" required placeholder="15.00">
                </div>

                <div class=""form-group>
                    <label>Imagenes del producto (Cloudonary)</label>

                    <input type="url" id="productImage1" required placeholder="URL imagen color 1">

                    <input type="url" id="productImage2" required placeholder="URL imagen color 2">

                    <input type="url" id="productImage3" required placeholder="URL imagen color 3">

                    <small> 
                        Pega las URLs de Cloudinary. Máximo 3 imágenes (colores).
                    </small>
                    
                </div>

                <div class="form-group">
                    <label for="productLink">Enlace de Compra *</label>
                    <input type="url" id="productLink" required placeholder="https://wa.me/...">
                </div>

                <div class="form-buttons">
                    <button type="submit" class="btn-primary">
                        <i class="fa-solid fa-save"></i> Guardar Producto
                    </button>
                    <button type="button" onclick="cancelEdit()" class="btn-secondary">
                        <i class="fa-solid fa-times"></i> Cancelar
                    </button>
                </div>
            </form>
        </div>

        <!-- ===== LISTA DE PRODUCTOS ===== -->
        <div class="admin-products-list">
            <h3>Productos Registrados</h3>
            <div id="adminProductsList">
                <!-- Renderizado por JS -->
            </div>
        </div>
    </section>

    <!-- ==========================
         SCRIPTS
         ========================== -->
    <script src="script/auth.js"></script>
    <script src="script/products.js"></script>
    <script src="script/admin.js"></script>

    <script>
        // Proteger página
        requireAuth();

        // Mostrar usuario
        const session = getSessionData();
        if (session) {
            document.getElementById('currentUser').textContent = session.username;
        }

        function handleLogout() {
            if (confirm('¿Estás seguro de que deseas cerrar sesión?')) {
                logout();
            }
        }

        // Advertencia sesión
        setInterval(() => {
            const timeRemaining = getSessionTimeRemaining();
            if (timeRemaining <= 5 && timeRemaining > 0) {
                console.warn(`Tu sesión expirará en ${timeRemaining} minutos`);
            }
        }, 60000);
    </script>

</body>
</html>
